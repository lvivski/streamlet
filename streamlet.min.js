!function(n){"use strict";function t(n){if(this.__listeners__=[],arguments.length>0){var t=new e(this);if("function"==typeof n)try{n(function(n){t.next(n)},function(n){t.fail(n)},function(){t.done()})}catch(o){t.fail(o)}else t.add(n)}}function e(n){this.stream=n}function o(n,e){var o=new t;return o.isSync=!0,n.addEventListener(e,function(n){o.add(n)},!1),o}function r(n){return n&&"function"==typeof n}function i(n){if(1===n.length&&Array.isArray(n[0]))return n[0];for(var t=new Array(n.length),e=0;e<t.length;)t[e]=n[e++];return t}function u(n){var t=Array.prototype.slice.call(arguments,1);f(function(){n.apply(null,t)})}var f;"function"==typeof define&&define.amd?define(["subsequent"],function(n){return f=n,t}):"object"==typeof module&&module.exports?(module.exports=t,f=require("subsequent")):(n.Streamlet=t,f=n.subsequent),t.prototype.isDone=!1,t.prototype.isSync=!1,t.prototype.listen=function(n,t,e){if(!this.isDone){var o=this.__listeners__,r={next:n,fail:t,done:e};return o.push(r),function(){var n=o.indexOf(r);o.splice(n,1)}}},t.prototype.transform=function(n){var o=new e(new t);return this.listen(n(o),function(n){o.fail(n)},function(){o.done()}),o.stream},t.prototype.map=function(n){return this.transform(function(t){return function(e){e=n(e),t.add(e)}})},t.prototype.filter=function(n){return this.transform(function(t){return function(e){n(e)&&t.add(e)}})},t.prototype.skip=function(n){return this.transform(function(t){return function(e){n-->0?t.done():t.add(e)}})},t.prototype.take=function(n){return this.transform(function(t){return function(e){n-->0?t.add(e):t.done()}})},t.prototype.expand=function(n){return this.transform(function(t){return function(e){e=n(e);for(var o in e)t.add(e[o])}})},t.prototype.merge=function(n){return t.merge(this,n)},e.NEXT="next",e.FAIL="fail",e.DONE="done",e.prototype.add=e.prototype.next=function(n){this.update(e.NEXT,n)},e.prototype.fail=function(n){this.update(e.FAIL,n)},e.prototype.done=function(){this.update(e.DONE)},e.prototype.update=function(n,t){var o=this.stream;o.isDone||(o.isSync?e.handle(o.__listeners__,n,t):u(e.handle,o.__listeners__,n,t),n!==e.NEXT&&(o.isDone=!0,o.__listeners__=void 0))},e.handle=function(n,t,e){if(n.length)for(var o=0;o<n.length;){var i=n[o++],u=i[t],f=i.fail;if(r(u))try{u(e)}catch(s){if(!r(f))throw s;f(s)}}},t.create=function(){return new e(new t)},t.merge=function(n){n=i(n);for(var o=new e(new t),r=function(n){o.add(n)},u=0;u<n.length;)n[u++].listen(r);return o.stream},"object"==typeof window&&(window.on=function(n){return new o(this,n)},"object"==typeof Node&&(Node.prototype.on=window.on))}(this);
//# sourceMappingURL=streamlet.min.js.map