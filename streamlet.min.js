!function(n){"use strict";function t(n){if(this.__listeners__=[],arguments.length>0){var t=new e(this);if("function"==typeof n)try{n(function(n){t.next(n)},function(n){t.fail(n)},function(){t.done()})}catch(r){t.fail(r)}}}function e(n){this.stream=n}function r(n){return n&&"function"==typeof n}function o(n){if(1===n.length&&Array.isArray(n[0]))return n[0];for(var t=new Array(n.length),e=0;e<t.length;)t[e]=n[e++];return t}function i(n){var t=Array.prototype.slice.call(arguments,1);u(function(){n.apply(null,t)})}var u;"function"==typeof define&&define.amd?define(["subsequent"],function(n){return u=n,t}):"object"==typeof module&&module.exports?(module.exports=t,u=require("subsequent")):(n.Streamlet=t,u=n.subsequent),t.prototype.isDone=!1,t.prototype.isSync=!1,t.prototype.listen=function(n,t,e){if(!this.isDone){var r=this.__listeners__,o={next:n,fail:t,done:e};return r.push(o),function(){var n=(r||[]).indexOf(o);-1!==n&&r.splice(n,1)}}},t.prototype.transform=function(n){var e=t.control(this.isSync);return this.listen(n(e),function(n){e.fail(n)},function(){e.done()}),e.stream},t.prototype.pipe=function(n){var t=new e(n);return this.listen(function(n){t.next(n)},function(n){t.fail(n)},function(){t.done()}),n},e.NEXT="next",e.FAIL="fail",e.DONE="done",e.prototype.add=e.prototype.next=function(n){this.update(e.NEXT,n)},e.prototype.fail=function(n){this.update(e.FAIL,n)},e.prototype.done=function(){this.update(e.DONE)},e.prototype.update=function(n,t){var r=this.stream;r.isDone||(r.isSync?e.handle(r.__listeners__,n,t):i(e.handle,r.__listeners__,n,t),n===e.DONE&&(r.isDone=!0,r.__listeners__=void 0))},e.handle=function(n,t,e){if(n.length)for(var o=0;o<n.length;){var i=n[o++],u=i[t],f=i.fail;if(r(u))try{u(e)}catch(s){r(f)&&f(s)}}},t.prototype["catch"]=function(n){return this.listen(null,n)},t.prototype.end=function(n){return this.listen(null,null,n)},t.prototype.map=function(n){return this.transform(function(t){return function(e){e=n(e),t.add(e)}})},t.prototype.filter=function(n){return this.transform(function(t){return function(e){n(e)&&t.add(e)}})},t.prototype.skip=function(n){return this.transform(function(t){return function(e){n-->0||t.add(e)}})},t.prototype.skipWhile=function(n){return this.transform(function(t){return function(e){n(e)||t.add(e)}})},t.prototype.skipDuplicates=function(n,t){return n||(n=function(n,t){return n===t}),this.transform(function(e){return function(r){n(r,t)||e.add(t=r)}})},t.prototype.take=function(n){return this.transform(function(t){return function(e){n-->0?t.add(e):t.done()}})},t.prototype.takeWhile=function(n){return this.transform(function(t){return function(e){n(e)?t.add(e):t.done()}})},t.prototype.expand=function(n){return this.transform(function(t){return function(e){e=n(e);for(var r in e)t.add(e[r])}})},t.prototype.scan=function(n,t){return this.transform(function(e){return function(r){null!=t&&(r=n(t,r)),e.add(t=r)}})},t.prototype.merge=function(n){return t.merge(this,n)},t.control=function(n){var r=new t;return r.isSync=n,new e(r)},t.fromEvent=function(n,e){var r=new t(function(t){n.addEventListener(e,t,!1)});return r.isSync=!0,r},t.merge=function(n){n=o(arguments);for(var e=n[0].isSync,r=t.control(e),i=function(n){r.add(n)},u=0;u<n.length;)n[u++].listen(i);return r.stream}}(this);
//# sourceMappingURL=streamlet.min.js.map