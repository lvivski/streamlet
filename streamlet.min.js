!function(n){"use strict";function t(n){if(this.__listeners__=[],arguments.length>0){var t=new e(this);if("function"==typeof n)try{n(function(n){t.next(n)},function(n){t.fail(n)},function(){t.done()})}catch(o){t.fail(o)}}}function e(n){this.stream=n}function o(n){return n&&"function"==typeof n}function r(n){if(1===n.length&&Array.isArray(n[0]))return n[0];for(var t=new Array(n.length),e=0;e<t.length;)t[e]=n[e++];return t}function i(n){var t=Array.prototype.slice.call(arguments,1);u(function(){n.apply(null,t)})}var u;"function"==typeof define&&define.amd?define(["subsequent"],function(n){return u=n,t}):"object"==typeof module&&module.exports?(module.exports=t,u=require("subsequent")):(n.Streamlet=t,u=n.subsequent),t.prototype.isDone=!1,t.prototype.isSync=!1,t.prototype.listen=function(n,t,e){if(!this.isDone){var o=this.__listeners__,r={next:n,fail:t,done:e};return o.push(r),function(){var n=(o||[]).indexOf(r);-1!==n&&o.splice(n,1)}}},t.prototype.transform=function(n){var e=t.control(this.isSync),o=this.listen(n(e),function(n){e.fail(n)},function(){e.done()});return e.stream.end(o),e.stream},t.prototype.pipe=function(n){var t=new e(n),o=this.listen(function(n){t.next(n)},function(n){t.fail(n)},function(){t.done()});return n.end(o),n},e.NEXT="next",e.FAIL="fail",e.DONE="done",e.prototype.add=e.prototype.next=function(n){this.update(e.NEXT,n)},e.prototype.fail=function(n){this.update(e.FAIL,n)},e.prototype.done=function(){this.update(e.DONE)},e.prototype.update=function(n,t){var o=this.stream;o.isDone||(o.isSync?e.handle(o.__listeners__,n,t):i(e.handle,o.__listeners__,n,t),n===e.DONE&&(o.isDone=!0,o.__listeners__=void 0))},e.handle=function(n,t,e){if(n.length)for(var r=0;r<n.length;){var i=n[r++],u=i[t],f=i.fail;if(o(u))try{u(e)}catch(c){o(f)&&f(c)}}},t.prototype["catch"]=function(n){return this.listen(null,n)},t.prototype.end=function(n){return this.listen(null,null,n)},t.prototype.map=function(n){return this.transform(function(t){return function(e){e=n(e),t.add(e)}})},t.prototype.filter=function(n){return this.transform(function(t){return function(e){n(e)&&t.add(e)}})},t.prototype.skip=function(n){return this.transform(function(t){return function(e){n-- >0||t.add(e)}})},t.prototype.skipWhile=function(n){return this.transform(function(t){return function(e){n(e)||t.add(e)}})},t.prototype.skipDuplicates=function(n,t){return n||(n=function(n,t){return n===t}),this.transform(function(e){return function(o){n(o,t)||e.add(t=o)}})},t.prototype.take=function(n){return this.transform(function(t){return function(e){n-- >0?t.add(e):t.done()}})},t.prototype.takeWhile=function(n){return this.transform(function(t){return function(e){n(e)?t.add(e):t.done()}})},t.prototype.expand=function(n){return this.transform(function(t){return function(e){e=n(e);for(var o in e)t.add(e[o])}})},t.prototype.scan=function(n,t){return this.transform(function(e){return function(o){null!=t&&(o=n(t,o)),e.add(t=o)}})},t.prototype.merge=function(n){return t.merge(this,n)},t.control=function(n){var o=new t;return o.isSync=n,new e(o)},t.fromEvent=function(n,e){var o=t.control(!0);return n.addEventListener(e,function(n){o.add(n)},!1),o.stream},t.fromPromise=function(n){var e=t.control();return onFullfilled=function(n){e.add(n),e.done()},onRejected=function(n){e.fail(n),e.done()},n.then(onFullfilled,onRejected),e.stream},t.merge=function(n){n=r(arguments);for(var e=n[0].isSync,o=t.control(e),i=n.length,u=0,f=function(n){o.add(n)},c=function(n){o.fail(n)},s=function(){--i>0||o.done()};i>u;)n[u++].listen(f,c,s);return o.stream}}(Function("return this")());
//# sourceMappingURL=streamlet.min.js.map